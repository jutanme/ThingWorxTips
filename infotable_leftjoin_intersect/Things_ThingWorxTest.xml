<?xml version="1.0" encoding="UTF-8" standalone="no"?><Entities build="b112" majorVersion="9" minorVersion="2" modelPersistenceProviderPackage="PostgresPersistenceProviderPackage" revision="1" schemaVersion="1120" universal=""><Things><Thing description="" documentationContent="" effectiveThingPackage="ConfiguredThing" enabled="true" homeMashup="" identifier="" inheritedValueStream="" lastModifiedDate="2022-01-15T09:58:17.095Z" name="ThingWorxTest" projectName="PTCDefaultProject" published="false" tags="" thingTemplate="GenericThing" valueStream=""><Owner name="Administrator" type="User"/><avatar/><DesignTimePermissions><Create/><Read/><Update/><Delete/><Metadata/></DesignTimePermissions><RunTimePermissions/><VisibilityPermissions><Visibility/></VisibilityPermissions><ConfigurationTableDefinitions/><ConfigurationTables/><ThingShape><PropertyDefinitions><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.dataShape="MMAD.BadItem.DS" aspect.isPersistent="true" baseType="INFOTABLE" category="" description="" isLocalOnly="false" name="info1" ordinal="3"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.dataShape="MMAD.CheckBoxInfo.DS" aspect.isPersistent="true" baseType="INFOTABLE" category="" description="" isLocalOnly="false" name="info2" ordinal="3"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.dataShape="MMAD.SelectItem.DS" aspect.isPersistent="true" baseType="INFOTABLE" category="" description="" isLocalOnly="false" name="info3" ordinal="4"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.dataShape="Combine1.DS" aspect.isPersistent="true" baseType="INFOTABLE" category="" description="" isLocalOnly="false" name="infotable1" ordinal="5"/><PropertyDefinition aspect.cacheTime="0.0" aspect.dataChangeType="VALUE" aspect.dataShape="Combin2.DS" aspect.isPersistent="true" baseType="INFOTABLE" category="" description="" isLocalOnly="false" name="infotable2" ordinal="6"/></PropertyDefinitions><ServiceDefinitions><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="InfoCombine"><ResultType baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition><ServiceDefinition aspect.isAsync="false" category="" description="" isAllowOverride="false" isLocalOnly="false" isOpen="false" isPrivate="false" name="InfoIntersect"><ResultType baseType="INFOTABLE" description="" name="result" ordinal="0"/><ParameterDefinitions/></ServiceDefinition></ServiceDefinitions><EventDefinitions/><ServiceMappings/><ServiceImplementations><ServiceImplementation description="" handlerName="Script" name="InfoCombine"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var result = me.infotable1;
var info2Obj = {};
//var params = {
//table: me.infotable2 /* INFOTABLE */
//};
//var info2fields = Resources["InfoTableFunctions"].ToJSON(params);

//info2fields.array = info2fields.rows;
//delete info2fields.rows;
//delete info2fields.dataShape;
        //logger.trace("info2fields:" + JSON.stringify(info2fields));
var fields2 = ["Data"];
var types2 = ["STRING"];
//var fields2 = infotable2Fields.split(",");
//var types2 = infotable2BaseTypes.split(",");
var join  = ["ID","Name"];

for(var i=0;i<fields2.length;i++) result.AddField({ name: fields2[i], baseType: types2[i] });


//    logger.error("info2fields:" +result.ToJSON());
for each(var row2 in me.infotable2.rows) {
    var keyStr = "";
    for(var i=0; i<join.length; i++) {
    	keyStr += row2[join[i]] + "_";
    }
//    logger.error("info2fields:" +keyStr+row2);
    info2Obj[keyStr] = row2;
//    logger.error("info2fields:" +info2Obj[keyStr] );
}


//var dataFields = Resources["InfoTableFunctions"].ToJSON({table: me.infotable2}).dataShape.fieldDefinitions;
var found,objFind = {};
var rowlist = me.infotable1.rows;
for (var i=0; i<result.getRowCount(); i++) {
    //objFind = {};
    //for(var i=0;i<join.length;i++)  objFind[join[i]] = row[join[i]];
    //found = me.infotable2.Find(objFind);
    var keyStr = "";
    for(var k=0; k<join.length; k++) {
    	keyStr += result.rows[i][join[k]] + "_";
    }
    found = info2Obj[keyStr];
    if (found!=null) {
        logger.error("Combine:" + found);
        for(var j=0;j<fields2.length;j++) result.rows[i][fields2[j]]=found[fields2[j]];
        //me.infotable2.Delete(found);
    }
}
//me.infotable1.rows = rowlist;
//for each(row in me.infotable2.rows) {
//   result.AddRow(row);
//}]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation><ServiceImplementation description="" handlerName="Script" name="InfoIntersect"><ConfigurationTables><ConfigurationTable dataShapeName="" description="" isMultiRow="false" name="Script" ordinal="0"><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="code" name="code" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><code><![CDATA[var params = {
     columns2: "Value",
     columns1: "Item",
     joinType: "LEFT",
     t1: me.info3,
     t2: me.info2,
     joinColumns1: "Item",
     joinColumns2: "Title"
};
var result = Resources["InfoTableFunctions"].Intersect(params);]]></code></Row></Rows></ConfigurationTable></ConfigurationTables></ServiceImplementation></ServiceImplementations><Subscriptions/></ThingShape><PropertyBindings/><RemotePropertyBindings/><RemoteServiceBindings/><RemoteEventBindings/><AlertConfigurations><AlertDefinitions name="info1"/><AlertDefinitions name="info2"/><AlertDefinitions name="info3"/><AlertDefinitions name="infotable1"/><AlertDefinitions name="infotable2"/></AlertConfigurations><ImplementedShapes/><ThingProperties><info1><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="DateStr" ordinal="0"/></FieldDefinitions></DataShape><Rows/></infoTable></Value><Timestamp>1970-01-01T00:00:00.000Z</Timestamp><Quality>UNKNOWN</Quality></info1><infotable1><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition baseType="STRING" description="" name="Data" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="ID" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Name" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Type" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><ID><![CDATA[1]]></ID><Name><![CDATA[a]]></Name><Type><![CDATA[a]]></Type></Row><Row><ID><![CDATA[2]]></ID><Name><![CDATA[b]]></Name><Type><![CDATA[b]]></Type></Row><Row><ID><![CDATA[3]]></ID><Name><![CDATA[c]]></Name><Type><![CDATA[c]]></Type></Row></Rows></infoTable></Value><Timestamp>2022-01-15T10:01:01.816Z</Timestamp><Quality>GOOD</Quality></infotable1><infotable2><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Data" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="ID" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Name" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><Data><![CDATA[d1]]></Data><ID><![CDATA[1]]></ID><Name><![CDATA[a]]></Name></Row><Row><Data><![CDATA[d2]]></Data><ID><![CDATA[2]]></ID><Name><![CDATA[b]]></Name></Row></Rows></infoTable></Value><Timestamp>2022-01-13T11:38:06.103Z</Timestamp><Quality>GOOD</Quality></infotable2><info3><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Item" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Value" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><Item><![CDATA[a]]></Item><Value><![CDATA[1]]></Value></Row><Row><Item><![CDATA[b]]></Item><Value><![CDATA[2]]></Value></Row></Rows></infoTable></Value><Timestamp>2022-01-13T09:08:39.568Z</Timestamp><Quality>GOOD</Quality></info3><info2><Value><infoTable><DataShape><FieldDefinitions><FieldDefinition aspect.isPrimaryKey="false" baseType="BOOLEAN" description="" name="Checked" ordinal="0"/><FieldDefinition aspect.isPrimaryKey="false" baseType="STRING" description="" name="Title" ordinal="0"/></FieldDefinitions></DataShape><Rows><Row><Checked>true</Checked><Title><![CDATA[a]]></Title></Row><Row><Title><![CDATA[b]]></Title></Row><Row><Checked>true</Checked><Title><![CDATA[c]]></Title></Row></Rows></infoTable></Value><Timestamp>2022-01-13T09:02:38.701Z</Timestamp><Quality>GOOD</Quality></info2></ThingProperties><ConfigurationChanges><ConfigurationChange changeAction="CREATE" changeReason="header : name : updated, projectName : updated&#10;" timestamp="2022-01-13T08:56:44.172Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : added&#10;" timestamp="2022-01-13T08:57:57.309Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : updated, info2 : added&#10;" timestamp="2022-01-13T09:01:47.605Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : removed, info1 : added&#10;" timestamp="2022-01-13T09:03:44.535Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : updated&#10;" timestamp="2022-01-13T09:04:19.559Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : updated&#10;" timestamp="2022-01-13T09:06:13.324Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info1 : updated&#10;" timestamp="2022-01-13T09:07:28.937Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : info3 : added&#10;" timestamp="2022-01-13T09:08:10.513Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoIntersect : service added&#10;" timestamp="2022-01-13T09:58:17.129Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoIntersect : service updated&#10;" timestamp="2022-01-13T09:58:46.259Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoIntersect : service updated&#10;" timestamp="2022-01-13T10:01:05.841Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service added&#10;" timestamp="2022-01-13T10:14:43.908Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : infotable1 : added, infotable2 : added&#10;" timestamp="2022-01-13T10:15:23.322Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T10:23:28.559Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : infotable1 : removed, infotable2 : removed&#10;" timestamp="2022-01-13T10:23:50.425Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : infotable1 : added, infotable2 : added&#10;" timestamp="2022-01-13T11:00:20.797Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : infotable1 : updated&#10;" timestamp="2022-01-13T11:01:11.929Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="properties : infotable2 : updated&#10;" timestamp="2022-01-13T11:01:26.531Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:03:49.185Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:05:11.436Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:06:05.073Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:07:29.376Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:08:40.913Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:10:17.466Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:11:14.466Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:12:49.239Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:15:27.297Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:17:11.616Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:23:23.988Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:30:35.273Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:31:07.916Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:34:16.893Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:37:43.429Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:54:46.466Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:57:18.715Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T11:58:16.176Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T12:00:21.779Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T14:56:24.110Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:01:10.419Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:01:35.009Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:04:00.811Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:05:27.994Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:09:34.097Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:10:13.481Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:11:31.782Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:12:08.846Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:12:22.259Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:14:12.462Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:15:00.438Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:16:37.059Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:17:53.232Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:18:32.163Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:22:43.844Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:25:43.934Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:26:29.274Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:27:18.327Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:30:06.344Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:33:40.340Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:34:34.486Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-13T15:36:31.435Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-15T09:56:48.533Z" user="Administrator"/><ConfigurationChange changeAction="MODIFY" changeReason="services : InfoCombine : service updated&#10;" timestamp="2022-01-15T09:58:17.016Z" user="Administrator"/></ConfigurationChanges></Thing></Things></Entities>